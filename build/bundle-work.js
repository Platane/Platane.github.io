var DomHelper=new function(){this.getWidth=function(t){return t.offsetWidth},this.getHeight=function(t){return t.offsetHeight},this.setPosition=function(t,e,r){t.style.left=e+"px",t.style.top=r+"px"};var t=["webkitTransform","mozTransform","transform"];this.setPosition=function(e,r,n){for(var i="translate3d("+r+"px,"+n+"px,0px)",a=t.length;a--;)e.style[t[a]]=i},this.getX=function(e){for(var r="",n=t.length;n--&&!(r=e.style[t[n]]););var i=r.match(/\( *([\d.-]+)/);return i?+i[1]:0},this.getY=function(e){for(var r="",n=t.length;n--&&!(r=e.style[t[n]]););var i=r.match(/\( *[\d.-]+ *px *, *([\d.-]+)/);return i?+i[1]:0},this.getXOffset=function(t){return t.offsetLeft},this.hasClass=function(t,e){return t.classList.contains(e)},this.addClass=function(t,e){t.className+=" "+e},this.removeClass=function(t,e){for(var r="",n=t.classList.length;n--;)e!=t.classList[n]&&(r+=" "+t.classList[n]);t.className=r},this.getParent=function(t,e){for(;;){if(!t||this.hasClass(t,e))break;t=t.parentElement}return t},this.bind=function(t,e,r){var n=e.split(" ");if(n.length>1)for(var i=n.length;i--;)this.bind(t,n[i],r);else t._bindHandlers=t._bindHandlers||{},this.unbind(t,e),t.addEventListener(e.split(".")[0],r,!1),t._bindHandlers[e]=r},this.unbind=function(t,e){var r=e.split(" ");if(r.length>1)for(var n=r.length;n--;)this.unbind(t,r[n]);else t._bindHandlers&&t._bindHandlers[e]&&(t.removeEventListener(e.split(".")[0],t._bindHandlers[e],!1),t._bindHandlers[e]=null)}};!function(){for(var t=document.querySelectorAll(".work-illu-main div"),e=t.length;e--;){for(var r=t[e].style.backgroundImage,n=["","-webkit-radial-gradient(65% 50%,ellipse cover,rgba(0,0,0,0) 52%,rgba(60, 60, 60, 1) 104%),","-msie-radial-gradient(65% 50%,ellipse cover,rgba(0,0,0,0) 52%,rgba(60, 60, 60, 1) 104%),","-moz-radial-gradient(65% 50%,ellipse cover,rgba(0,0,0,0) 52%,rgba(60, 60, 60, 1) 104%),","radial-gradient(65% 50%,ellipse cover,rgba(0,0,0,0) 52%,rgba(60, 60, 60, 1) 104%),"],i=n.length;i--;)n[i]="background-image:"+n[i]+r+";";t[e].setAttribute("style",n.join(""))}}();var gridLayout=function(t){var e=t.querySelectorAll(".grid-tile"),r=[],n=function(n){for(var i=1/0,a=0,s=e.length;s>a;a++)r[a]=r[a]||{},r[a].w=DomHelper.getWidth(e[a]),r[a].h=DomHelper.getHeight(e[a]),r[a].large=e[a].className.indexOf("grid-tile-large")>=0,r[a].i=a,r[a].w<i&&(i=r[a].w);o(DomHelper.getWidth(t),i,r),"function"==typeof n&&n(r);for(var a=0,s=e.length;s>a;a++)DomHelper.setPosition(e[a],r[a].x,r[a].y)},i=function(){this._array=[],this.sum=0};i.prototype.push=function(t){this.sum+=t.h,this._array.unshift(t)},i.prototype.pop=function(){var t=this._array.shift();return this.sum-=t.h,t},i.prototype.first=function(){return this.length()?this._array[0]:null},i.prototype.length=function(){return this._array.length},i.prototype.whatIfPop=function(t){for(var e=this.sum,r=0;t>r&&r<this._array.length;r++)e-=this._array[r].h;return e};var a,o=function(e,r,n){for(var a=Math.floor(e/r+.01),o=function(){for(var t=a-1,e=u[t].whatIfPop(w[t]),r=a-1;r--;){var n=u[r].whatIfPop(w[r]);n>e&&(e=n,t=r)}return t},s=function(){for(var t=a-1,e=u[t].whatIfPop(w[t]),r=a-1;r--;){var n=u[r].whatIfPop(w[r]);e>n&&(e=n,t=r)}return t},l=function(){var t=o(),e=s();return u[t].whatIfPop(w[t])-u[e].whatIfPop(w[e])},u=new Array(a),d=a;d--;)(u[d]=new i).sum=d%2*30;for(var c=n.slice();c.length;){var f=c.shift();if(f.large){for(var h,g=120,p=f.y,m=1/0,v=[],d=a;d--;)v.push(0);for(var w=v.slice();;){var y=o(),b=s(),k=u[y].whatIfPop(w[y]),P=u[b].whatIfPop(w[b]);if(p+g>k){var H=2*(k-P)+5*Math.abs(p-(P+k)/2);m>H&&(m=H,v=w.slice(),h=k)}if(p-(P+k)/2>m)break;for(var x=1/0,A=-1,d=a;d--;)if(!(w[d]>=u[d].length())){w[d]++;var q=l();w[d]--,x>q&&(A=d,x=q)}if(-1==A)break;w[A]++}for(var S=[],d=a;d--;)for(var C=v[d];C--;)S.push(u[d].pop());S=S.sort(function(t,e){return t.i<e.i?1:-1}),c=S.concat(c),f.x=0,f.y=Math.max(h,(p+h)/2);for(var d=a;d--;)u[d].sum=f.y+f.h}else{for(var I=a-1,_=a-1;_--;)u[I].sum>=u[_].sum&&(I=_);f.x=I/a*e,f.y=u[I].sum,u[I].push(f)}}for(var L=u[a-1].sum,_=a-1;_--;)u[_].sum>L&&(L=u[_].sum);t.style.height=L+"px"};window.addEventListener("resize",function(){clearTimeout(a),a=setTimeout(n,100)},!1),n(function(t){for(var e=r.length;e--;)t[e].x=Math.random()<.5?-window.innerWidth:window.innerWidth});for(var s=(t.offsetHeight,e.length);s--;)e[s].className+=" grid-animated",e[s].style.transitionDelay=(100*Math.random()|0)+"ms";return setTimeout(n,200),{update:n}}(document.getElementsByClassName("grid")[0]),worksActions=function(){for(var t=DomHelper,e=null,r=function(r){e!=r&&(n(),t.addClass(r,"grid-tile-large"),gridLayout.update(),e=r,t.bind(document,"click.outside-tile",function(e){t.hasClass(e.target,"work")||t.getParent(e.target,"work")||n()}),r.offsetWidth,t.addClass(r,"grid-tile-large-opened"))},n=function(){e&&(t.removeClass(e,"grid-tile-large"),t.removeClass(e,"grid-tile-large-opened"),gridLayout.update(),t.unbind(document,"click.outside-tile"),contentIllustrationActions&&contentIllustrationActions.close(e.querySelector(".work-main")),e=null)},i=document.querySelectorAll(".work"),a=i.length;a--;)t.bind(i[a],"click.open",function(e){r(t.getParent(this,"grid-tile")),e.stopPropagation()}),t.bind(i[a].querySelector(".work-close-button"),"click.close-button",function(e){n(t.getParent(this,"grid-tile")),e.stopPropagation()});return{open:r,close:n}}(),contentIllustrationActions=function(){for(var t=DomHelper,e=function(t){var e=t.querySelector(".work-content"),r=t.querySelector(".work-illu-panel"),n=t.querySelector(".work-nav"),i=e.offsetWidth,a=t.offsetWidth,o=n.offsetWidth,s=a-o-50;e.style.width=i+"px",r.style.width=s+"px"},r=function(t){var e=t.querySelector(".work-content"),r=t.querySelector(".work-illu-panel");e.style.width=r.style.width=""},n=function(r){var n=r.querySelector(".work-content-wrapper");e(r),t.addClass(r,"illu-displayed"),t.unbind(n,"transitionEnd.clear-after-out-anim webkitTransitionEnd.clear-after-out-anim"),t.unbind(n,"click.close"),window.setTimeout(function(){t.bind(n,"click.close",function(){i(r)})},100)},i=function(e){var n=e.querySelector(".work-content-wrapper");t.removeClass(e,"illu-displayed"),t.unbind(n,"click.close"),t.bind(n,"transitionEnd.clear-after-out-anim webkitTransitionEnd.clear-after-out-anim",function(){r(e),t.unbind(n,"transitionEnd.clear-after-out-anim webkitTransitionEnd.clear-after-out-anim")})},a=function(t,e,r){var n=t.querySelector(".work-illu-primar div"),i=t.querySelector(".work-illu-caption");n.style.backgroundImage="url("+e+")",i.innerHTML=r||""},o=document.querySelectorAll(".work-illu.work-illu-secondary"),s=o.length;s--;)t.bind(o[s],"click.emphase-illu",function(){var e=t.getParent(this,"work-main");t.hasClass(e,"illu-displayed")?a(e,this.getAttribute("data-image"),this.getAttribute("data-caption")):(n(e),a(e,this.getAttribute("data-image"),this.getAttribute("data-caption"),!0))}),a(t.getParent(o[s],"work-main"),o[s].getAttribute("data-image"),o[s].getAttribute("data-caption"),!0);for(var l=document.querySelectorAll(".work-content-wrapper"),s=l.length;s--;)t.bind(l[s],"mousedown.drag",function(r){var a=this,o=t.getParent(a,"work-main"),s=r.pageX,l=t.getWidth(a);e(o),a.style.width=l+"px",t.addClass(a,"dragged");var u=(new Date).getTime();t.bind(window,"mousemove.dragging",function(t){var e=t.pageX;a.style.width=Math.max(0,l+(s-e))+"px"}),t.bind(window,"mouseup.dragging",function(){t.removeClass(a,"dragged"),t.unbind(window,"mouseup.dragging"),t.unbind(window,"mousemove.dragging"),a.style.width="",(new Date).getTime()-u<300||(t.getWidth(a)<200?n(o):i(o))})});return{open:n,close:i,changeIllu:a}}();