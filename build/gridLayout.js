var gridLayout=function(r){var t=r.querySelectorAll(".grid-tile"),e=[],a=function(a){for(var o=1/0,n=0,f=t.length;f>n;n++)e[n]=e[n]||{},e[n].w=DomHelper.getWidth(t[n]),e[n].h=DomHelper.getHeight(t[n]),e[n].large=t[n].className.indexOf("grid-tile-large")>=0,e[n].i=n,e[n].w<o&&(o=e[n].w);i(DomHelper.getWidth(r),o,e),"function"==typeof a&&a(e);for(var n=0,f=t.length;f>n;n++)DomHelper.setPosition(t[n],e[n].x,e[n].y)},o=function(){this._array=[],this.sum=0};o.prototype.push=function(r){this.sum+=r.h,this._array.unshift(r)},o.prototype.pop=function(){var r=this._array.shift();return this.sum-=r.h,r},o.prototype.first=function(){return this.length()?this._array[0]:null},o.prototype.length=function(){return this._array.length},o.prototype.whatIfPop=function(r){for(var t=this.sum,e=0;r>e&&e<this._array.length;e++)t-=this._array[e].h;return t};var n,i=function(t,e,a){for(var n=Math.floor(t/e+.01),i=function(){for(var r=n-1,t=s[r].whatIfPop(d[r]),e=n-1;e--;){var a=s[e].whatIfPop(d[e]);a>t&&(t=a,r=e)}return r},f=function(){for(var r=n-1,t=s[r].whatIfPop(d[r]),e=n-1;e--;){var a=s[e].whatIfPop(d[e]);t>a&&(t=a,r=e)}return r},h=function(){var r=i(),t=f();return s[r].whatIfPop(d[r])-s[t].whatIfPop(d[t])},s=new Array(n),u=n;u--;)(s[u]=new o).sum=u%2*30;for(var l=a.slice();l.length;){var p=l.shift();if(p.large){for(var m,v=120,c=p.y,g=1/0,y=[],u=n;u--;)y.push(0);for(var d=y.slice();;){var w=i(),P=f(),I=s[w].whatIfPop(d[w]),x=s[P].whatIfPop(d[P]);if(c+v>I){var _=2*(I-x)+5*Math.abs(c-(x+I)/2);g>_&&(g=_,y=d.slice(),m=I)}if(c-(x+I)/2>g)break;for(var H=1/0,D=-1,u=n;u--;)if(!(d[u]>=s[u].length())){d[u]++;var M=h();d[u]--,H>M&&(D=u,H=M)}if(-1==D)break;d[D]++}for(var W=[],u=n;u--;)for(var b=y[u];b--;)W.push(s[u].pop());W=W.sort(function(r,t){return r.i<t.i?1:-1}),l=W.concat(l),p.x=0,p.y=Math.max(m,(c+m)/2);for(var u=n;u--;)s[u].sum=p.y+p.h}else{for(var N=n-1,T=n-1;T--;)s[N].sum>=s[T].sum&&(N=T);p.x=N/n*t,p.y=s[N].sum,s[N].push(p)}}for(var k=s[n-1].sum,T=n-1;T--;)s[T].sum>k&&(k=s[T].sum);r.style.height=k+"px"};window.addEventListener("resize",function(){clearTimeout(n),n=setTimeout(a,100)},!1),a(function(r){for(var t=e.length;t--;)r[t].x=Math.random()<.5?-window.innerWidth:window.innerWidth});for(var f=(r.offsetHeight,t.length);f--;)t[f].className+=" grid-animated",t[f].style.transitionDelay=(100*Math.random()|0)+"ms";return setTimeout(a,200),{update:a}}(document.getElementsByClassName("grid")[0]);